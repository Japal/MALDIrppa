<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Write intensity matrix in different formats — writeIntensity • MALDIrppa</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Write intensity matrix in different formats — writeIntensity" />
<meta property="og:description" content="This function writes an intensity matrix as generated by intensityMatrix into a file in the R, csv, NEXUS or FASTA formats. For NEXUS format it allows to specify weights for peaks." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MALDIrppa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MALDIrppa_vignette.html">Robust MALDI mass spectra data pre-processing pipeline with MALDIrppa</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Write intensity matrix in different formats</h1>
    
    <div class="hidden name"><code>writeIntensity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function writes an intensity matrix as generated by <code>intensityMatrix</code> into a file in the R, csv, NEXUS or FASTA formats. For NEXUS format it allows to specify weights for peaks.</p>
    </div>

    <pre class="usage"><span class='fu'>writeIntensity</span><span class='op'>(</span><span class='va'>x</span>, filename <span class='op'>=</span> <span class='st'>"intMatrix"</span>, format <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"R"</span>, <span class='st'>"csv"</span>, <span class='st'>"NEXUS"</span>, <span class='st'>"FASTA"</span><span class='op'>)</span>,
               binary <span class='op'>=</span> <span class='cn'>FALSE</span>, labels <span class='op'>=</span> <span class='cn'>NULL</span>, weights<span class='op'>=</span><span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Intensity matrix as obtained from <code>intensityMatrix</code>.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>A character string specifying a name for the destination file (filename extension not required).</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>One of R (default <code>.RData</code> file), text (comma-separated <code>.csv</code> file), NEXUS (<code>.nex</code> file) or FASTA (<code>.fas</code> file).</p></td>
    </tr>
    <tr>
      <th>binary</th>
      <td><p>Logical value. If <code>TRUE</code>, a binary version (1: peak presence, 0: peak absence) of <code>x</code> is saved (default <code>FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>Optional vector of ID labels for the samples.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Optional numeric vector of peak weights (NEXUS format).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is a wrapper function to simplify the writing of an intensity matrix in different formats while adding some extra features. It includes the common NEXUS and FASTA formats as an extension of functions in the <code>ape</code> package to handle peak intensity data. It also allows for taxa/sample pre-computed peak weights to be included in the NEXUS file. It checks whether the names meet NEXUS name conventions and gives them adequate format if not. A binary intensity matrix is always internally generated (<code>binary = TRUE</code>) when either the NEXUS or FASTA format is chosen. If any, <code>NA</code> values in <code>x</code> are assumed to denote zero intensity/peak absence and are then converted into zeros.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>No return value, file in selected format created on destination folder.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load example data</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>spectra</span><span class='op'>)</span> <span class='co'># list of MassSpectra class objects</span>

<span class='co'># Some pre-processing</span>

<span class='va'>spectra</span> <span class='op'>&lt;-</span> <span class='fu'><a href='screenSpectra.html'>screenSpectra</a></span><span class='op'>(</span><span class='va'>spectra</span><span class='op'>)</span><span class='op'>$</span><span class='va'>fspectra</span>
<span class='va'>spectra</span> <span class='op'>&lt;-</span> <span class='fu'>transformIntensity</span><span class='op'>(</span><span class='va'>spectra</span>, method <span class='op'>=</span> <span class='st'>"sqrt"</span><span class='op'>)</span>
<span class='va'>spectra</span> <span class='op'>&lt;-</span> <span class='fu'><a href='wavSmoothing.html'>wavSmoothing</a></span><span class='op'>(</span><span class='va'>spectra</span><span class='op'>)</span>
<span class='va'>spectra</span> <span class='op'>&lt;-</span> <span class='fu'>removeBaseline</span><span class='op'>(</span><span class='va'>spectra</span><span class='op'>)</span>
<span class='va'>peaks</span> <span class='op'>&lt;-</span> <span class='fu'>detectPeaks</span><span class='op'>(</span><span class='va'>spectra</span><span class='op'>)</span>
<span class='va'>peaks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='alignPeaks.html'>alignPeaks</a></span><span class='op'>(</span><span class='va'>peaks</span>, minFreq <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span>

<span class='co'># Intensity matrix</span>

<span class='va'>int</span> <span class='op'>&lt;-</span> <span class='fu'>intensityMatrix</span><span class='op'>(</span><span class='va'>peaks</span><span class='op'>)</span>

<span class='co'># Save as R file (saved to a temporary location as an example)</span>
<span class='co'># \donttest{</span>
<span class='fu'>writeIntensity</span><span class='op'>(</span><span class='va'>int</span>, file <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"int"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># }</span>
<span class='co'># Save as binary NEXUS file (saved to a temporary location as an example)</span>
<span class='co'># \donttest{</span>
<span class='fu'>writeIntensity</span><span class='op'>(</span><span class='va'>int</span>, file <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>,<span class='st'>"int.binary"</span><span class='op'>)</span>,
               format <span class='op'>=</span> <span class='st'>"NEXUS"</span>, interleaved <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Javier Palarea-Albaladejo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


