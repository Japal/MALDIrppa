<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Detection of outlying mass peak profiles — detectOutliers • MALDIrppa</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Detection of outlying mass peak profiles — detectOutliers" />
<meta property="og:description" content="This function identifies outlying cases in a collection of processed mass peak profiles. It can be applied either on peak intensities or binary data (peak presence/absence patterns). It allows to specify a grouping factor in order to execute the procedure at the desired level of aggregation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MALDIrppa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MALDIrppa_vignette.html">Robust MALDI mass spectra data pre-processing pipeline with MALDIrppa</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detection of outlying mass peak profiles</h1>
    
    <div class="hidden name"><code>detectOutliers.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function identifies outlying cases in a collection of processed mass peak profiles. It can be applied either on peak intensities or binary data (peak presence/absence patterns). It allows to specify a grouping factor in order to execute the procedure at the desired level of aggregation.</p>
    </div>

    <pre class="usage"><span class='fu'>detectOutliers</span>(<span class='no'>x</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>binary</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A list of <code>MassSpectrum</code> objects containing processed peaks.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>If given, a grouping variable (<code><a href='https://rdrr.io/r/base/factor.html'>factor</a></code> or <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code>) subsetting the data.</p></td>
    </tr>
    <tr>
      <th>binary</th>
      <td><p>Logical value. It indicates whether the procedure must be applied on either peak intensities (<code>FALSE</code>, default) or on binary peak presence/absence patterns (<code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Optional arguments for the robust outlier detection method.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function marks samples with mass peak profiles that largely deviates from other samples at the given aggregation level. It uses robust methods for the detection of multivariate outliers applied on metric multidimensional scaling (MDS) coordinates (Euclidean distance is used for peak intensities and binary distance for binary profiles; see <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>). The number of MDS coordinates used is generally set to p = <code>floor</code>(n/2), where n is the number of samples in the target subset. This is an upper cap recommended for the computation of the robust MCD estimator by <code>covMcd</code>. However, that rule of thumb can still generate matrix singularity problems with <code>covMcd</code> in some cases. When this occurs <code>detectOutliers</code> further reduces p to use the maximum number of MDS coordinates giving rise to a non-singular covariance matrix (min(p) = 2 in any case). The adaptive multivariate outlier detection algorithm was adapted from the <code>mvoutlier</code> package.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>by = NULL</code>, a logical vector of length equal to the number of elements of <code>x</code> indicating outlying samples by <code>TRUE</code>. Otherwise, a 2-column <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> is generated which includes such a logical vector along with the grouping variable given in <code>by</code>.
<!-- %%\item{outlier }{} --></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load example data</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>spectra</span>) <span class='co'># list of MassSpectra class objects</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>type</span>) <span class='co'># metadata</span>

<span class='co'># Some pre-processing</span>

<span class='no'>sc.results</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='screenSpectra.html'>screenSpectra</a></span>(<span class='no'>spectra</span>,<span class='kw'>meta</span><span class='kw'>=</span><span class='no'>type</span>)
<span class='no'>spectra</span> <span class='kw'>&lt;-</span> <span class='no'>sc.results</span>$<span class='no'>fspectra</span> <span class='co'># filtered mass spectra</span>
<span class='no'>type</span> <span class='kw'>&lt;-</span> <span class='no'>sc.results</span>$<span class='no'>fmeta</span>    <span class='co'># filtered metadata  </span>
<span class='no'>spectra</span> <span class='kw'>&lt;-</span> <span class='fu'>transformIntensity</span>(<span class='no'>spectra</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"sqrt"</span>)
<span class='no'>spectra</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='wavSmoothing.html'>wavSmoothing</a></span>(<span class='no'>spectra</span>)
<span class='no'>spectra</span> <span class='kw'>&lt;-</span> <span class='fu'>removeBaseline</span>(<span class='no'>spectra</span>)
<span class='no'>peaks</span> <span class='kw'>&lt;-</span> <span class='fu'>detectPeaks</span>(<span class='no'>spectra</span>)
<span class='no'>peaks</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='alignPeaks.html'>alignPeaks</a></span>(<span class='no'>peaks</span>, <span class='kw'>minFreq</span> <span class='kw'>=</span> <span class='fl'>0.8</span>)

<span class='co'># Find outlying samples at isolate level</span>
<span class='co'># \donttest{</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>detectOutliers</span>(<span class='no'>peaks</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='no'>type</span>$<span class='no'>isolate</span>)

<span class='co'># From peak presence/absence patterns</span>

<span class='no'>out.binary</span> <span class='kw'>&lt;-</span> <span class='fu'>detectOutliers</span>(<span class='no'>peaks</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='no'>type</span>$<span class='no'>isolate</span>, <span class='kw'>binary</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Javier Palarea-Albaladejo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


